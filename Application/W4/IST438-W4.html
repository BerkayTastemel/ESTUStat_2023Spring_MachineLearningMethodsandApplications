<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-03-20">

<title>IST438-W4-Applications</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="IST438-W4_files/libs/clipboard/clipboard.min.js"></script>
<script src="IST438-W4_files/libs/quarto-html/quarto.js"></script>
<script src="IST438-W4_files/libs/quarto-html/popper.min.js"></script>
<script src="IST438-W4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="IST438-W4_files/libs/quarto-html/anchor.min.js"></script>
<link href="IST438-W4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="IST438-W4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="IST438-W4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="IST438-W4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="IST438-W4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">IST438-W4-Applications</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 20, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="model-validation-and-pre-processing" class="level1">
<h1>Model validation and pre-processing</h1>
<p>In this application, we will interest to get more predictions of model performance and using some pre-processing steps:</p>
<ul>
<li>Model validation techniques</li>
<li>Handling missing data</li>
<li>Transformations</li>
</ul>
</section>
<section id="packages" class="level1">
<h1>Packages</h1>
<p>We need to install <code>{naniar}</code> and <code>{DALEX}</code> package to use functions to handle missing data and <code>titanic</code> data set in applications. Please use the two-step codes below: (1) install, (2) load the package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("caret") </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("naniar") </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("DALEX")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DALEX)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-validation" class="level1">
<h1>1. MODEL VALIDATION</h1>
<p>In here, we can focus on the predicting survive status of titanic passengers.</p>
<p>You can use <code>trainControl()</code> function in <code>{caret}</code> package to configurate the validation way. Then <code>train()</code> function to train a logistic regression model. Let’s follow the steps below:</p>
<ul>
<li><ol type="1">
<li>Obtain the method and the parameters belonging to.</li>
</ol></li>
<li><ol start="2" type="1">
<li>Train model considering the previous step.</li>
</ol></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="fu">as.factor</span>(survived) <span class="sc">~</span>., <span class="co"># model formula</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> titanic_imputed, <span class="co"># all data (not train data!)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> control,    <span class="co"># validation setup</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"glm"</span>)         <span class="co"># method you used to train model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see the model output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Linear Model 

2207 samples
   7 predictor
   2 classes: '0', '1' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1986, 1986, 1987, 1987, 1986, 1987, ... 
Resampling results:

  Accuracy   Kappa    
  0.7988554  0.5095597</code></pre>
</div>
</div>
<p>It returns the model used, dimension of data set, and some info about the folds. If you want to see more details about the process:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>resample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Accuracy     Kappa Resample
1  0.8190045 0.5444238   Fold01
2  0.7782805 0.4616455   Fold02
3  0.7818182 0.4568460   Fold03
4  0.7954545 0.5160344   Fold04
5  0.7963801 0.5206536   Fold05
6  0.8181818 0.5509746   Fold06
7  0.8099548 0.5293103   Fold07
8  0.7432432 0.3806167   Fold08
9  0.8181818 0.5714425   Fold09
10 0.8280543 0.5636496   Fold10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  parameter  Accuracy     Kappa AccuracySD   KappaSD
1      none 0.7988554 0.5095597 0.02571808 0.0595742</code></pre>
</div>
</div>
<p>It is seen that the model performance looks stable because the accuracy values of the model changes between 0.74 and 0.82 in folds. The average accuracy is about 0.80.</p>
<p>We can also validate the model by using the LOOCV method. It may takes for a while because the LOOCV method is computationally expensive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"LOOCV"</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">savePredictions =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="fu">as.factor</span>(survived) <span class="sc">~</span>., <span class="co"># model formula</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> titanic_imputed, <span class="co"># all data (not train data!)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">trControl =</span> control,    <span class="co"># validation setup</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"glm"</span>)         <span class="co"># method you used to train model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized Linear Model 

2207 samples
   7 predictor
   2 classes: '0', '1' 

No pre-processing
Resampling: Leave-One-Out Cross-Validation 
Summary of sample sizes: 2206, 2206, 2206, 2206, 2206, 2206, ... 
Resampling results:

  Accuracy   Kappa    
  0.7970095  0.5056671</code></pre>
</div>
</div>
<p>If you want to discover more about the package, visit here: https://topepo.github.io/caret/</p>
</section>
<section id="missing-data" class="level1">
<h1>2. MISSING DATA</h1>
<p>The easiest way to check the missing values in data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anyNA</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<section id="missing-data-summaries" class="level2">
<h2 class="anchored" data-anchor-id="missing-data-summaries">2.1. Missing data summaries</h2>
<p>We can summarizes the missing values in vector or data frame format. To summarize the missing values in a data set, <code>{naniar}</code> provides very useful functions as below:</p>
<ul>
<li><code>n_miss()</code> returns number of missing values in data set</li>
<li><code>n_complete()</code> returns number of completed (aka not missing) values in data set</li>
<li><code>miss_var_summary()</code> returns number and percentage of missing values in data set for each variable</li>
<li><code>miss_case_summary()</code> returns number and percentage of missing values in data set for each observation</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">n_miss</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 129</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">n_complete</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19734</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
  variable n_miss pct_miss
  &lt;chr&gt;     &lt;int&gt;    &lt;dbl&gt;
1 country      81   3.67  
2 fare         26   1.18  
3 sibsp        10   0.453 
4 parch        10   0.453 
5 age           2   0.0906
6 gender        0   0     
7 class         0   0     
8 embarked      0   0     
9 survived      0   0     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_summary</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,207 × 3
    case n_miss pct_miss
   &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1   577      4     44.4
 2   145      3     33.3
 3   151      3     33.3
 4   238      3     33.3
 5   517      3     33.3
 6   616      3     33.3
 7   681      3     33.3
 8  1095      3     33.3
 9  1190      3     33.3
10  1305      3     33.3
# … with 2,197 more rows</code></pre>
</div>
</div>
<ul>
<li><code>miss_var_table()</code> returns a summary table consists number and percentage of missing values over variables.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_table</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  n_miss_in_var n_vars pct_vars
          &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
1             0      4     44.4
2             2      1     11.1
3            10      2     22.2
4            26      1     11.1
5            81      1     11.1</code></pre>
</div>
</div>
<p>The table shows that there are four variables do not have and missing values, and the other variables have different number of missing values.</p>
<p>We can visualize the missing values to see the big picture!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="IST438-W4_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The graph above shows that the <span class="math inline">\(0.6\%\)</span> of the observations is missing. Most of these missing values is in the <code>country</code> feature (aka variable). Also, the variables <code>fare</code>, <code>sibsp</code>, <code>parch</code>, and <code>age</code> have some missing values.</p>
<p>We can also visualize the missing values by variable and observation level.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="IST438-W4_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_case</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="IST438-W4_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="deletion-removing" class="level2">
<h2 class="anchored" data-anchor-id="deletion-removing">2.2. Deletion (Removing)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> titanic[<span class="fu">complete.cases</span>(titanic), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="imputation" class="level2">
<h2 class="anchored" data-anchor-id="imputation">2.3. Imputation</h2>
<p>Imputation can be done for a single feature or all data observations. Let’s try to impute a feature first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(titanic) <span class="co"># call the data again because we deleted the observation </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>              <span class="co"># in previous subsection</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>titanic<span class="sc">$</span>age[<span class="fu">is.na</span>(titanic<span class="sc">$</span>age)] <span class="ot">&lt;-</span> <span class="fu">median</span>(titanic<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can use <code>preProcess()</code> function from <code>{caret}</code> package to impute the missing values in all data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(titanic)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>impute_mean <span class="ot">&lt;-</span> <span class="fu">preProcess</span>(titanic, <span class="at">method =</span> <span class="st">"medianImpute"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>titanic_imp <span class="ot">&lt;-</span> <span class="fu">predict</span>(impute_mean, titanic) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s check it is done:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anyNA</span>(titanic_imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>There is still some missing values in the data set, but they are in categorical features. Because the imputation methods based on mean, median, and etc. do not work with categorical features. In the categorical variables, you can impute missing values with the most frequently seen class in the complete part of the feature.</p>
</section>
</section>
<section id="transformations" class="level1">
<h1>3. TRANSFORMATIONS</h1>
<p>Let’s check the scale of the features in <code>titanic_imputed</code> data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(titanic_imputed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    gender          age                       class            embarked   
 female: 489   Min.   : 0.1667   1st             :324   Belfast    : 197  
 male  :1718   1st Qu.:22.0000   2nd             :284   Cherbourg  : 271  
               Median :29.0000   3rd             :709   Queenstown : 123  
               Mean   :30.4363   deck crew       : 66   Southampton:1616  
               3rd Qu.:38.0000   engineering crew:324                     
               Max.   :74.0000   restaurant staff: 69                     
                                 victualling crew:431                     
      fare             sibsp            parch           survived     
 Min.   :  0.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:  0.000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  
 Median :  7.151   Median :0.0000   Median :0.0000   Median :0.0000  
 Mean   : 19.992   Mean   :0.2959   Mean   :0.2284   Mean   :0.3222  
 3rd Qu.: 21.000   3rd Qu.:0.0000   3rd Qu.:0.0000   3rd Qu.:1.0000  
 Max.   :512.061   Max.   :8.0000   Max.   :9.0000   Max.   :1.0000  
                                                                     </code></pre>
</div>
</div>
<p>It is seen that the scale of <code>age</code> and <code>fare</code> is quite different. The scale of <code>age</code> is between 0 and 74, while the scale of <code>fare</code> is between 0 and 512. They are not in same/similar scale. This may be effective on the model performance.</p>
<p>You can try to transform the data set then compare the model performance with and without transformations.</p>
<section id="min-max-transformation" class="level2">
<h2 class="anchored" data-anchor-id="min-max-transformation">3.1. Min-max transformation</h2>
<p>Min-max transformation maps the values of feature to the interval of [0, 1]. <code>preProcess()</code> function from <code>{caret}</code> package can be used to transform the data set. It is needed to set <code>="range"</code> the <code>method</code> argument in the function to use the min-max transformation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">preProcess</span>(titanic_imputed[, <span class="sc">-</span><span class="dv">8</span>], <span class="at">method =</span> <span class="st">"range"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>scaled_titanic <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">predict</span>(pp, titanic_imputed[, <span class="sc">-</span><span class="dv">8</span>]), <span class="at">survived =</span> titanic_imputed[,<span class="dv">8</span>])</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(titanic_imputed), <span class="fu">round</span>(<span class="fu">nrow</span>(titanic_imputed) <span class="sc">*</span> <span class="fl">0.80</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>train_scaled <span class="ot">&lt;-</span> scaled_titanic[index, ]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>test_scaled  <span class="ot">&lt;-</span> scaled_titanic[<span class="sc">-</span>index, ]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> titanic_imputed[index, ]</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>test  <span class="ot">&lt;-</span> titanic_imputed[<span class="sc">-</span>index, ]</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>model_scaled <span class="ot">&lt;-</span> <span class="fu">glm</span>(survived <span class="sc">~</span> ., <span class="at">data =</span> train_scaled, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>predicted_probs_scaled <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_scaled, test_scaled[,<span class="sc">-</span><span class="dv">8</span>], <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>predicted_classes_scaled <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predicted_probs_scaled <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">table</span>(test<span class="sc">$</span>survived,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>                      predicted_classes_scaled),</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">"1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

   predicted_classes_scaled
      0   1
  0 295  25
  1  44  77
                                          
               Accuracy : 0.8435          
                 95% CI : (0.8062, 0.8762)
    No Information Rate : 0.7687          
    P-Value [Acc &gt; NIR] : 6.621e-05       
                                          
                  Kappa : 0.5869          
                                          
 Mcnemar's Test P-Value : 0.03024         
                                          
            Sensitivity : 0.7549          
            Specificity : 0.8702          
         Pos Pred Value : 0.6364          
         Neg Pred Value : 0.9219          
             Prevalence : 0.2313          
         Detection Rate : 0.1746          
   Detection Prevalence : 0.2744          
      Balanced Accuracy : 0.8126          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<p>Let’s compare the model performance with the model trained on untransformed data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(survived <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>predicted_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, test[,<span class="sc">-</span><span class="dv">8</span>], <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>predicted_classes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predicted_probs <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">table</span>(test<span class="sc">$</span>survived,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>                      predicted_classes),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">"1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

   predicted_classes
      0   1
  0 295  25
  1  44  77
                                          
               Accuracy : 0.8435          
                 95% CI : (0.8062, 0.8762)
    No Information Rate : 0.7687          
    P-Value [Acc &gt; NIR] : 6.621e-05       
                                          
                  Kappa : 0.5869          
                                          
 Mcnemar's Test P-Value : 0.03024         
                                          
            Sensitivity : 0.7549          
            Specificity : 0.8702          
         Pos Pred Value : 0.6364          
         Neg Pred Value : 0.9219          
             Prevalence : 0.2313          
         Detection Rate : 0.1746          
   Detection Prevalence : 0.2744          
      Balanced Accuracy : 0.8126          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<p>It is seen that the performance of the models are totally same! This means that there is no change seen in the model performance after scaling.</p>
</section>
<section id="normalization" class="level2">
<h2 class="anchored" data-anchor-id="normalization">3.2. Normalization</h2>
<p>Normalization transformation maps the values of feature to normalize. <code>preProcess()</code> function from <code>{caret}</code> package can be used to transform the data set. It is needed to set <code>=c("center", "scale")</code> the <code>method</code> argument in the function to use the normalization transformation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">preProcess</span>(train[, <span class="sc">-</span><span class="dv">8</span>], <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>centered_titanic <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">predict</span>(pp, titanic_imputed[, <span class="sc">-</span><span class="dv">8</span>]), <span class="at">survived =</span> titanic_imputed[,<span class="dv">8</span>])</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>train_centered <span class="ot">&lt;-</span> centered_titanic[index, ]</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>test_centered  <span class="ot">&lt;-</span> centered_titanic[<span class="sc">-</span>index, ]</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>model_centered <span class="ot">&lt;-</span> <span class="fu">glm</span>(survived <span class="sc">~</span> ., <span class="at">data =</span> train_centered, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>predicted_probs_centered <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_centered, test_centered[,<span class="sc">-</span><span class="dv">8</span>], <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>predicted_classes_centered <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predicted_probs_centered <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">table</span>(test<span class="sc">$</span>survived,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                      predicted_classes_centered),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">"1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

   predicted_classes_centered
      0   1
  0 295  25
  1  44  77
                                          
               Accuracy : 0.8435          
                 95% CI : (0.8062, 0.8762)
    No Information Rate : 0.7687          
    P-Value [Acc &gt; NIR] : 6.621e-05       
                                          
                  Kappa : 0.5869          
                                          
 Mcnemar's Test P-Value : 0.03024         
                                          
            Sensitivity : 0.7549          
            Specificity : 0.8702          
         Pos Pred Value : 0.6364          
         Neg Pred Value : 0.9219          
             Prevalence : 0.2313          
         Detection Rate : 0.1746          
   Detection Prevalence : 0.2744          
      Balanced Accuracy : 0.8126          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<p>It is also seen that the performance of the models are totally same! This means that there is no change seen in the model performance after normalization.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>